jQuery(document).ready(function($){var debug=!0;var debug=!1;if(Joomla.optionsStorage===null){var Options=Joomla.getOptions('validationary');Joomla.optionsStorage={'validationary':Options}}
if(debug)console.log(Joomla.optionsStorage.validationary);$.validationary=$.validationary||{};$.validationary.validateAjax=function($parent){if(debug)console.log(Joomla.optionsStorage.validationary.forms);$.each(Joomla.optionsStorage.validationary.forms,function(formSelector,formOptions){var allowSubmit=function(){if(formOptions.submit_button_enabled){return}
var disable=!0;for(;;){var errorLoading=$form.find('.error, .loading').not('select');if(errorLoading.length>0){break}
var required=$form.find(formOptions.fields_selector_required).not('label').not('fieldset').not('div').not('.validated');if(required.length<1){disable=!1;break}
break}
if(disable){$submit.attr("disabled","disabled");if($fa){$fa.removeClass('fa-check-circle-o');$fa.addClass('fa-close')}}
else{$submit.removeAttr("disabled");$fa.addClass('fa-check-circle-o')}
if($fa){$fa.removeClass('fa-spin fa-spinner')}};if(debug)console.log(formSelector);var $form=$($parent.find(formSelector));if(!$form.length){return}
var $submit=$($form.find('*[type="submit"]'));var $fa=!1;switch(formOptions.fontawesome){case 'include':case 'included':$fa=$($submit.find('.fa'));if($fa.length<1){$submit.prepend(Joomla.optionsStorage.validationary.loading_snippet_light);$fa=$($submit.find('.fa'))}
break;default:break}
allowSubmit();if(!$form.hasClass('validationary')){$form.addClass('validationary')}
else{return}
var fields_selectors=[formOptions.fields_selector_required,formOptions.fields_selector_only_validate];formOptions.fields_selector=[];var k=0;for(i=0;i<fields_selectors.length;i++){if(fields_selectors[i].length>0){formOptions.fields_selector[k]=fields_selectors[i];k++}}
formOptions.fields_selector=formOptions.fields_selector.join(',');var $fields=$form.find(formOptions.fields_selector).not('label').not('fieldset').not('div').not('.validation_setup');var $fields_required=$form.find(formOptions.fields_selector_required).not('label').not('fieldset').not('div');$fields_required.data('required',!0);var $fields_only_validate=$form.find(formOptions.fields_selector_only_validate).not('label').not('fieldset').not('div');$fields_only_validate.data('required',!1);if(!$fields.length){return}
var timer;var usePopover=!0;var useMessageUnderField=!1;var popoverPlacement;switch(Joomla.optionsStorage.validationary.behavior){case 'bootstrap3':popoverPlacement='auto';break;default:popoverPlacement='right'}
var makeFieldUntouched=function($this){if(useMessageUnderField){$response.html()}
$this.removeClass('validated invalid error loading');if($this.hasClass('hasPopover')&&$this.popoverWasChanged){var $label=$this.parent().find('label');if($label.length<0){$this.popover();return}
var opts={title:'',placement:popoverPlacement,trigger:'hover',html:'true',};opts.title=$label.attr('title')||$label.data('original-title');if(!opts.title||opts.title.length<0){return}
var tmp=opts.title.split('</strong><br />');if(tmp.length>1){opts.title=tmp[0]+'</strong>';opts.content=tmp[1]}
$this.data('toggle','popover');$this.popover(opts).popover().popover('hide')}
allowSubmit()};var validateFields=function($elements){for(i=0;i<$elements.length;i++){validateField(null,$($elements[i]))}
allowSubmit()};var validateField=function(event,$element){var $this=$element||$(this);$this.addClass('validation_setup');var tagName=$this.prop("tagName");if(tagName==='SELECT'&&$this.data('required')){var $chzn=$this.next('.chzn-container')||!1;var $chzn=$this.parent().find('.chzn-container')||!1;if($chzn.length){$chzn.removeClass('error');$chzn.removeClass('validated')}
$this.parent().removeClass('error');if(!$this.val().length){$this.addClass('error');if($chzn.length){$chzn.addClass('error')}
else{$this.parent().addClass('error')}}
else{$this.addClass('validated');if($chzn.length){$chzn.addClass('validated')}}
allowSubmit();return}
var previous_value=$this.data('previous_value');if(previous_value==$this.val()){return}
$this.data('previous_value',$this.val());var xhr=$this.data('xhr');if(xhr){$this.removeClass('loading');xhr.abort()}
$this.popoverWasChanged=$this.popoverWasChanged||!1;if($this.attr('name').indexOf("jform[")<0){return}
var $response;if(useMessageUnderField){$response=$this.parent().find(".response")}
if(!$this.val().length){makeFieldUntouched($this);allowSubmit();return}
if(timer){if(event){clearTimeout(timer)}}
timer=setTimeout(function(){if(!$this.data('required')&&!$this.val().length){makeFieldUntouched($this);allowSubmit();return}
var form=$form.serializeArray();var form_task;var form_option;for(i=0;i<form.length;i++){if(form[i].name=='option'||form[i].name=='task'){if(form[i].name=='task'){form_task=form[i].value}
if(form[i].name=='option'){form_option=form[i].value}
index=form.indexOf(form[i]);if(index>-1){form.splice(index,1);i=i-1}}}
form=form.concat([{name:"form_task",value:form_task},{name:"form_option",value:form_option},{name:"field_to_validate",value:$this.attr('name')},{name:"rule_number",value:formOptions.rule_number}]);if(useMessageUnderField){if(!$response.length){$('<div class="response"></>').insertAfter($this);$response=$this.parent().find(".response")}
$response.data('loading-text',Joomla.optionsStorage.validationary.loading_snippet);$response.button('loading');$response.removeClass('error')}
if(usePopover){$this.addClass('loading');$this.popover('destroy');$this.popoverWasChanged=!0}
$this.removeClass('error validated');if($fa){$fa.addClass('fa-spin fa-spinner');if(!formOptions.submit_button_enabled){$submit.attr("disabled","disabled")}}
xhr=$.post(Joomla.optionsStorage.validationary.ajax_url,form,function(response,success,dataType){var message;var failed=!1;if(dataType.getResponseHeader("content-type")=='text/html'){messsage=response;failed=!0}
else{message=response.message;if(!response.success){failed=!0}}
$this.removeClass('loading');if(failed===!0){$this.addClass('error');if(useMessageUnderField){$response.addClass('error');$response.html(message)}
if(usePopover){var opts={title:message,placement:popoverPlacement,trigger:'hover',html:'true',};if(response.messages){opts.content='';$.each(response.messages,function(type,msgs){var alertsuffix='';if(formOptions.useAlerts){switch(Joomla.optionsStorage.validationary.behavior){case 'bootstrap3':switch(type){case 'message':alertsuffix='';break;case 'notice':alertsuffix='info';break;case 'warning':alertsuffix='warning';break;case 'error':alertsuffix='danger';break;default:}
break;default:alertsuffix=type}}
var classes='';if(alertsuffix.length){classes='alert alert-'+alertsuffix}
opts.content=opts.content+'<div class="'+classes+'" role="alert"><ol><li>'+msgs.join('</li><li>')+'</li></ol></div>'})}
$this.data('toggle','popover');$this.popover(opts).popover('show');$this.popoverWasChanged=!0}}
else{makeFieldUntouched($this);$this.addClass('validated')}
if(response.data&&response.data.reCheckFields&&event){var end_glue='"]';var glue=' input[name="';var selector=glue+response.data.reCheckFields.join(end_glue+', '+glue)+end_glue;var $elements=$parent.find(selector);$elements.data('previous_value','');validateFields($elements)}
else{allowSubmit()}});$this.data('xhr',xhr)},500)};$fields.on('blur keyup datechange ',validateField);$fields.on(' change',function(){validateField(null,$(this))});validateFields($fields)})};$.validationary.validateAjax($('body'))})